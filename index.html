// تنظیم بوم و محورهای مختصات
const canvas = document.getElementById("vectorCanvas");
const ctx = canvas.getContext("2d");

// تنظیم اندازه‌ی مربع
const size = Math.min(window.innerWidth * 0.9, 600);
canvas.width = size;
canvas.height = size;

const center = { x: size / 2, y: size / 2 };
const scale = size / 120; // برای اینکه بازه‌ی -50 تا +50 نمایش داده شود

// تابع رسم محورهای مختصات
function drawAxes() {
  ctx.clearRect(0, 0, size, size);
  ctx.beginPath();
  ctx.strokeStyle = "#555";
  ctx.lineWidth = 1;

  // محور X
  ctx.moveTo(0, center.y);
  ctx.lineTo(size, center.y);

  // محور Y
  ctx.moveTo(center.x, 0);
  ctx.lineTo(center.x, size);
  ctx.stroke();

  // تقسیم‌بندی‌ها
  ctx.fillStyle = "#333";
  ctx.font = "10px Arial";
  for (let i = -50; i <= 50; i += 10) {
    const x = center.x + i * scale;
    const y = center.y - i * scale;
    // محور x
    ctx.beginPath();
    ctx.moveTo(x, center.y - 3);
    ctx.lineTo(x, center.y + 3);
    ctx.stroke();
    ctx.fillText(i, x - 5, center.y + 12);
    // محور y
    ctx.beginPath();
    ctx.moveTo(center.x - 3, y);
    ctx.lineTo(center.x + 3, y);
    ctx.stroke();
    if (i !== 0) ctx.fillText(i, center.x + 6, y + 3);
  }
}

// تابع رسم پیکان بردار
function drawArrow(fromX, fromY, toX, toY, color) {
  const headLength = 10;
  const dx = toX - fromX;
  const dy = toY - fromY;
  const angle = Math.atan2(dy, dx);
  ctx.beginPath();
  ctx.moveTo(fromX, fromY);
  ctx.lineTo(toX, toY);
  ctx.strokeStyle = color;
  ctx.lineWidth = 3;
  ctx.stroke();

  // نوک پیکان
  ctx.beginPath();
  ctx.moveTo(toX, toY);
  ctx.lineTo(toX - headLength * Math.cos(angle - Math.PI / 6), toY - headLength * Math.sin(angle - Math.PI / 6));
  ctx.lineTo(toX - headLength * Math.cos(angle + Math.PI / 6), toY - headLength * Math.sin(angle + Math.PI / 6));
  ctx.closePath();
  ctx.fillStyle = color;
  ctx.fill();
}

// تابع اصلی
function drawVector() {
  const x = parseFloat(document.getElementById("x").value);
  const y = parseFloat(document.getElementById("y").value);
  const k = parseFloat(document.getElementById("k").value);
  const resultDiv = document.getElementById("result");

  if (isNaN(x) || isNaN(y) || isNaN(k)) {
    resultDiv.innerText = "لطفاً مقادیر معتبر وارد کنید.";
    return;
  }

  drawAxes();

  // بردار اصلی
  const toX = center.x + x * scale;
  const toY = center.y - y * scale;
  drawArrow(center.x, center.y, toX, toY, "green");

  // بردار حاصل‌ضرب
  const kx = k * x;
  const ky = k * y;
  const toX2 = center.x + kx * scale;
  const toY2 = center.y - ky * scale;
  drawArrow(center.x, center.y, toX2, toY2, "red");

  resultDiv.innerHTML = `بردار اصلی A = (${x}, ${y})<br>بردار ضرب‌درضریب ${k}A = (${kx}, ${ky})`;
}

// رسم اولیه
drawAxes();
